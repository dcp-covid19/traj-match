!function(t){var r={};function n(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,r){if(1&r&&(t=n(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)n.d(e,o,function(r){return t[r]}.bind(null,o));return e},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="",n(n.s=5)}([function(t,r){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,r){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,r){(function(r){t.exports=r}).call(this,{})},function(t,r,n){var e={},o=n(8),u=n(17),f=o("43553");e.pnorm=function(t,r=0,n=1,e=!0,o=!1){if(n<0)return NaN;let i=.5*(1+u((t-r)/n/Math.sqrt(2)));return e||(i=1-i),o&&(i=Math.log(i)),i},e.rnorm=function(t=0,r=1){return Math.sqrt(-2*Math.log(f()))*Math.cos(2*Math.PI*f())*r+t},e.dpois=function(t,r){let n,e=0;if(isNaN(t)||isNaN(r)||r<0)return NaN;if(!Number.isInteger(t))return 0;if(t<0||!isFinite(t))return 0;n=-r+(t=Math.round(t))*Math.log(r);for(let r=1;r<=t;r++)e+=Math.log(r);let o=n-e;return Math.exp(o)},sum=function(t){var r=[];for(i=0;i<t[0].length;i++){var n=0;for(j=0;j<t.length;j++)n+=t[j][i];r.push(n)}return r},sp=function(t,r){var n=[];for(i=0;i<r.length;i++)n.push(t*r[i]);return n},abs=function(t){var r=0;for(i=0;i<t.length;i++)r+=Math.pow(Math.abs(t[i]),2);return Math.sqrt(r)},e.sortAscendingByKey=function(t,r){return t.sort((function(t,n){return Number(t[r])===Number(n[r])?0:Number(t[r])<Number(n[r])?-1:1}))},e.sortFunction=function(t,r){return Number(t[t.length-1])===Number(r[t.length-1])?0:Number(t[t.length-1])<Number(r[t.length-1])?1:-1},e.odeMethod=function(t,r,n,e,o,i,u,f){let a,s,c,l,x,p,h,d,v,m,g,b,y;switch(t){case"euler":return a=r(e,n,i,u,f),sum([n,sp(o,a)]);case"rk4":return y=[0,1/3,2/3,1],a21=1/3,a31=-1/3,a32=1,a41=1,a42=-1,a43=1,g=[0,1/8,3/8,3/8,1/8],s=r(e,n,i,u,f),c=r(e+y[2]*o,sum([n,sp(o*a21,s)]),i,u,f),l=r(e+y[3]*o,sum([n,sp(o*a31,s),sp(o*a32,c)]),i,u,f),x=r(e+y[4]*o,sum([n,sp(o*a41,s),sp(o*a42,c),sp(o*a43,l)]),i,u,f),sum([n,sp(o*g[1],sum([c,l])),sp(o*g[2],sum([s,c]))]);case"rkf45":return y=[0,0,.25,3/8,12/13,1,.5],m=[[0,0,0,0,0],[0,0,0,0,0,0],[0,.25,0,0,0,0],[0,3/32,9/32,0,0,0],[0,1932/2197,-7200/2197,7296/2197,0,0],[0,439/216,-8,3680/513,-845/4104,0],[0,-8/27,2,-3544/2565,1859/4104,-.275]],g=[0,25/216,0,1408/2565,2197/4104,-.2,0],b=[0,16/135,0,6656/12825,28561/56430,-.18,2/55],s=r(e,n,i,u,f),c=r(e+y[2]*o,sum([n,sp(o*m[2][1],s)]),i,u,f),l=r(e+y[3]*o,sum([n,sp(o*m[3][1],s),sp(o*m[3][2],c)]),i,u,f),x=r(e+y[4]*o,sum([n,sp(o*m[4][1],s),sp(o*m[4][2],c),sp(o*m[4][3],l)]),i,u,f),p=r(e+y[5]*o,sum([n,sp(o*m[5][1],s),sp(o*m[5][2],c),sp(o*m[5][3],l),sp(o*m[5][4],x)]),i,u,f),h=r(e+y[6]*o,sum([n,sp(o*m[6][1],s),sp(o*m[6][2],c),sp(o*m[6][3],l),sp(o*m[6][4],x),sp(o*m[6][5],p)]),i,u,f),d=sum([n,sp(o*g[1],s),sp(o*g[2],c),sp(o*g[3],l),sp(o*g[4],x),sp(o*g[5],p),sp(o*g[6],h)]),v=sum([n,sp(o*b[1],s),sp(o*b[2],c),sp(o*b[3],l),sp(o*b[4],x),sp(o*b[5],p),sp(o*b[6],h)])}},e.TrajIntegrate=function(t,r,n,o,i,u){var f,a,s,c,l=i[0],x=i[1],p=i[2],h=(t[5],t[6],[]);let d=e.interpolator(r),v=e.interpolator(n);var m,g=snippet.initz(d(l),t[7],t[8],t[9],t[10]),b=l,y=0;for(dt=u;0===y;){c=g;for(let r=0;r<200;r++)f=d(b+r/200*dt),a=v(b+r/200*dt),g=e.odeMethod("rkf45",snippet.skeleton,g,b+r/200*dt,.005*dt,t,f,a);s=b,(b+=dt)>x&&(b=s,dt=x-s,g=c),b>=x&&(b=s+dt,y=1,h.push(g[4]))}for(m=0;b<p;){"undefined"!==Number(o[m+1][0])?dt=Number(o[m+1][0])-Number(o[m][0]):dt=u,g[4]=0;for(let r=0;r<200;r++)f=d(b+r/200*dt),a=v(b+r/200*dt),g=e.odeMethod("rkf45",snippet.skeleton,g,b+r/200*dt,.005*dt,t,f,a),H=g[4];b+=dt,m++,h.push(H)}return h},e.interpolator=function(t){var r,n,e,o,i=t.length-1;return 0===t.length?function(){return 0}:1===t.length?function(){return t[0][1]}:(t=t.sort((function(t,r){return t[0]-r[0]})),r=t[0],e=function(r){var n=t[0],e=t[1];return n[1]+(r-n[0])*(e[1]-n[1])/(e[0]-n[0])},n=function(t,r,n){return r[1]+(t-r[0])*(n[1]-r[1])/(n[0]-r[0])},o=function(r){var n=t[i-1],e=t[i];return e[1]+(r-e[0])*(e[1]-n[1])/(e[0]-n[0])},function(u){var f;if(u<=r[0])return e(u);for(f=0;f<i;f+=1)if(u>t[f][0]&&u<=t[f+1][0])return n(u,t[f],t[f+1]);return o(u)})},t.exports=e},function(t,r){const n={R0:0,amplitude:1,gamma:2,mu:3,sigma:4,rho:5,psi:6,S_0:7,E_0:8,I_0:9,R_0:10,LogLik:11,param:function(t){for(let r=0;r<t.length;r++)console.log(Object.keys(n)[t[r]]);console.log(";")}};t.exports=n},function(t,r,n){"use strict";n.r(r);const e=n(6),o=self.workerfn=(...t)=>{let r,n=new Date;try{console.error("STARTING TRAJMATCH"),r=e(...t),console.log("workerfn result",r),isNaN(r[r.length-1])&&(r=[...new Array(t[0].length).fill(0),NaN])}catch(n){console.error(n),r=[...new Array(t[0].length).fill(0),NaN]}return console.debug(new Date-n),r};r.default=o},function(t,r,n){let e=n(7),o=n(3),i=n(4),u=n(28);TrajMatch=function(t,r,n,e,i,u,f){console.log("b4");let a=new Date;return TrajPopulation=o.interpolator(r),TrajBirthrate=o.interpolator(n),console.log(new Date-a),TrajMain(t,TrajPopulation,TrajBirthrate,e,i,u,f)},TrajMain=function(t,r,n,o,f,a,s){let c,l=Date.now(),x=0,p=0,h=[],d=[];progress();for(let r=0;r<t.length;r++)t[r]=Number(t[r]),a[r]===i.amplitude&&(d.push(r),r===i.amplitude||r===a.rho?h.push(Math.log(t[r]/(1-t[r]))):h.push(Math.log(t[r])));c=u.nelderMead((function(u){var a,c,p=0,h=0;for(let r=0;r<u.length;r++)d[r]===i.amplitude||d[r]===i.rho?t[d[r]]=1/(1+Math.exp(-u[r])):t[d[r]]=Math.exp(u[r]);a=t[5],c=t[6];var v=TrajIntegrate(t,r,n,o,f,s);for(let t=0;t<v.length;t++)p=e.dmeasure(a,c,v[t],o[t][1],1),h+=p;Date.now()-l>5e3&&(x<.7&&(x+=.01),l=Date.now(),progress(.2+x));return console.log(t,h),[-h.toFixed(6)]}),h);for(let r=0;r<t.length;r++)a[r]===i.amplitude&&(r===i.amplitude||r===i.rho?t[r]=1/(1+Math.exp(-c.x[p])):t[r]=Math.exp(c.x[p]),p++);return progress(1),console.log("returns??",t,c.fx),[...t,-c.fx]},TrajIntegrate=function(t,r,n,i,u,f){var a,s,c,l,x,p=u[0],h=u[1],d=u[2],v=[],m=e.initz(r(p),t[7],t[8],t[9],t[10]),g=p,b=0;for(dt=f;0===b;){l=m;for(let i=0;i<200;i++)a=r(g+i/200*dt),s=n(g+i/200*dt),m=o.odeMethod("rkf45",e.skeleton,m,g+i/200*dt,.005*dt,t,a,s);c=g,(g+=dt)>h&&(g=c,dt=h-c,m=l),g>=h&&(g=c+dt,b=1,v.push(m[4]))}for(x=0;g<d;){"undefined"!==Number(i[x+1][0])?dt=Number(i[x+1][0])-Number(i[x][0]):dt=f,m[4]=0;for(let i=0;i<200;i++)a=r(g+i/200*dt),s=n(g+i/200*dt),m=o.odeMethod("rkf45",e.skeleton,m,g+i/200*dt,.005*dt,t,a,s),H=m[4];g+=dt,x++,v.push(H)}return v},t.exports=TrajMatch},function(t,r,n){snippet={};let e=n(3),o=n(4);snippet.skeleton=function(t,r,n,e,i){let u,f,a=[],s=n[o.R0],c=n[o.amplitude],l=n[o.gamma],x=n[o.mu],p=n[o.sigma],h=s*(l+x)*(p+x)/p,d=r[0],v=r[1],m=r[2],g=r[3];f=t<1968?0:t>=1968&&t<=1969?.33:t>=1969&&t<=1970?.46:t>=1970&&t<=1971?.51:t>=1971&&t<=1972?.53:t>=1972&&t<=1973?.52:t>=1973&&t<=1974?.46:t>=1974&&t<=1975?.46:t>=1975&&t<=1976?.48:t>=1976&&t<=1977?.48:t>=1977&&t<=1978?.51:t>=1978&&t<=1979?.53:t>=1979&&t<=1980?.55:t>=1980&&t<=1981?.58:t>=1981&&t<=1982?.6:t>=1982&&t<=1983?.63:t>=1983&&t<=1984?.68:t>=1984&&t<=1985?.71:t>=1985&&t<=1988?.76:t>=1988&&t<=1989?.814:t>=1989&&t<=1990?.9488:t>=1990&&t<=1991?.9818:t>=1991&&t<=1992?.9:t>=1992&&t<=1993?.92:t>=1993&&t<=1994?.91:t>=1994&&t<=1995?.91:t>=1995&&t<=1996?.92:t>=1996&&t<=1997?.92:t>=1997&&t<=1998?.91:t>=1998&&t<=1999?.88:t>=1999&&t<=2e3?.88:t>=2e3&&t<=2001?.87:t>=2001&&t<=2002?.84:t>=2002&&t<=2003?.82:t>=2003&&t<=2004?.8:t>=2004&&t<=2005?.81:t>=2005&&t<=2006?.84:t>=2006&&t<=2007?.85:t>=2007&&t<=2008?.85:t>=2008&&t<=2009?.85:t>=2009&&t<=2010?.88:.89;var b=365.25*(t-Math.floor(t)),y=h*(u=b>=7&&b<=100||b>=115&&b<=199||b>=252&&b<=300||b>=308&&b<=356?1+.2411*c/.7589:1-c)/e;return a[0]=i*(1-f)-y*d*m-x*d,a[1]=y*d*m-(p+x)*v,a[2]=p*v-(l+x)*m,a[3]=l*m-x*g+i*f,a[4]=l*m,a},snippet.initz=function(t,r,n,e,o){var i=t/(r+n+o+e);return[r=Math.round(i*r),n=Math.round(i*n),e=Math.round(i*e),o=Math.round(i*o),0]},snippet.dmeasure=function(t,r,n,o,i){var u,f=t*n,a=f*(1-t+r*r*f),s=Number(o);return u=isNaN(s)?1:s>0?e.pnorm(s+.5,f,Math.sqrt(a)+1e-18,1,0)-e.pnorm(s-.5,f,Math.sqrt(a)+1e-18,1,0)+1e-18:e.pnorm(Math.sqrt(a)+1e-18)+1e-18,i&&(u=Math.log(u)),u},snippet.rmeasure=function(t,r,n){var o=r*t,i=o*(1-r+n*n*o),u=e.rnorm(o,Math.sqrt(i)+1e-18);return u=u>0?Math.round(u):0},t.exports=snippet},function(t,r,n){var e=n(9),o=n(10),i=n(11),u=n(12),f=n(13),a=n(14),s=n(15);s.alea=e,s.xor128=o,s.xorwow=i,s.xorshift7=u,s.xor4096=f,s.tychei=a,t.exports=s},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r,n=this,e=(r=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var e=.02519603282416938*(r+=t.charCodeAt(n));e-=r=e>>>0,r=(e*=r)>>>0,r+=4294967296*(e-=r)}return 2.3283064365386963e-10*(r>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=e(" "),n.s1=e(" "),n.s2=e(" "),n.s0-=e(t),n.s0<0&&(n.s0+=1),n.s1-=e(t),n.s1<0&&(n.s1+=1),n.s2-=e(t),n.s2<0&&(n.s2+=1),e=null}function f(t,r){return r.c=t.c,r.s0=t.s0,r.s1=t.s1,r.s2=t.s2,r}function a(t,r){var n=new u(t),e=r&&r.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,e&&("object"==typeof e&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.alea=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r=this,n="";r.x=0,r.y=0,r.z=0,r.w=0,r.next=function(){var t=r.x^r.x<<11;return r.x=r.y,r.y=r.z,r.z=r.w,r.w^=r.w>>>19^t^t>>>8},t===(0|t)?r.x=t:n+=t;for(var e=0;e<n.length+64;e++)r.x^=0|n.charCodeAt(e),r.next()}function f(t,r){return r.x=t.x,r.y=t.y,r.z=t.z,r.w=t.w,r}function a(t,r){var n=new u(t),e=r&&r.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,e&&("object"==typeof e&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.xor128=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r=this,n="";r.next=function(){var t=r.x^r.x>>>2;return r.x=r.y,r.y=r.z,r.z=r.w,r.w=r.v,(r.d=r.d+362437|0)+(r.v=r.v^r.v<<4^t^t<<1)|0},r.x=0,r.y=0,r.z=0,r.w=0,r.v=0,t===(0|t)?r.x=t:n+=t;for(var e=0;e<n.length+64;e++)r.x^=0|n.charCodeAt(e),e==n.length&&(r.d=r.x<<10^r.x>>>4),r.next()}function f(t,r){return r.x=t.x,r.y=t.y,r.z=t.z,r.w=t.w,r.v=t.v,r.d=t.d,r}function a(t,r){var n=new u(t),e=r&&r.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,e&&("object"==typeof e&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.xorwow=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r=this;r.next=function(){var t,n,e=r.x,o=r.i;return t=e[o],n=(t^=t>>>7)^t<<24,n^=(t=e[o+1&7])^t>>>10,n^=(t=e[o+3&7])^t>>>3,n^=(t=e[o+4&7])^t<<7,t=e[o+7&7],n^=(t^=t<<13)^t<<9,e[o]=n,r.i=o+1&7,n},function(t,r){var n,e=[];if(r===(0|r))e[0]=r;else for(r=""+r,n=0;n<r.length;++n)e[7&n]=e[7&n]<<15^r.charCodeAt(n)+e[n+1&7]<<13;for(;e.length<8;)e.push(0);for(n=0;n<8&&0===e[n];++n);for(8==n?e[7]=-1:e[n],t.x=e,t.i=0,n=256;n>0;--n)t.next()}(r,t)}function f(t,r){return r.x=t.x.slice(),r.i=t.i,r}function a(t,r){null==t&&(t=+new Date);var n=new u(t),e=r&&r.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,e&&(e.x&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.xorshift7=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r=this;r.next=function(){var t,n,e=r.w,o=r.X,i=r.i;return r.w=e=e+1640531527|0,n=o[i+34&127],t=o[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=o[i]=n^t,r.i=i,n+(e^e>>>16)|0},function(t,r){var n,e,o,i,u,f=[],a=128;for(r===(0|r)?(e=r,r=null):(r+="\0",e=0,a=Math.max(a,r.length)),o=0,i=-32;i<a;++i)r&&(e^=r.charCodeAt((i+32)%r.length)),0===i&&(u=e),e^=e<<10,e^=e>>>15,e^=e<<4,e^=e>>>13,i>=0&&(u=u+1640531527|0,o=0==(n=f[127&i]^=e+u)?o+1:0);for(o>=128&&(f[127&(r&&r.length||0)]=-1),o=127,i=512;i>0;--i)e=f[o+34&127],n=f[o=o+1&127],e^=e<<13,n^=n<<17,e^=e>>>15,n^=n>>>12,f[o]=e^n;t.w=u,t.X=f,t.i=o}(r,t)}function f(t,r){return r.i=t.i,r.w=t.w,r.X=t.X.slice(),r}function a(t,r){null==t&&(t=+new Date);var n=new u(t),e=r&&r.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,e&&(e.X&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.xor4096=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){(function(t){var e;!function(t,o,i){function u(t){var r=this,n="";r.next=function(){var t=r.b,n=r.c,e=r.d,o=r.a;return t=t<<25^t>>>7^n,n=n-e|0,e=e<<24^e>>>8^o,o=o-t|0,r.b=t=t<<20^t>>>12^n,r.c=n=n-e|0,r.d=e<<16^n>>>16^o,r.a=o-t|0},r.a=0,r.b=0,r.c=-1640531527,r.d=1367130551,t===Math.floor(t)?(r.a=t/4294967296|0,r.b=0|t):n+=t;for(var e=0;e<n.length+20;e++)r.b^=0|n.charCodeAt(e),r.next()}function f(t,r){return r.a=t.a,r.b=t.b,r.c=t.c,r.d=t.d,r}function a(t,r){var n=new u(t),e=r&&r.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,e&&("object"==typeof e&&f(e,n),o.state=function(){return f(n,{})}),o}o&&o.exports?o.exports=a:n(0)&&n(2)?void 0===(e=function(){return a}.call(r,n,r,o))||(o.exports=e):this.tychei=a}(0,t,n(0))}).call(this,n(1)(t))},function(t,r,n){var e;!function(o,i,u){var f,a=256,s=6,c="random",l=u.pow(a,s),x=u.pow(2,52),p=2*x,h=a-1;function d(t,r,n){var e=[],h=g(function t(r,n){var e,o=[],i=typeof r;if(n&&"object"==i)for(e in r)try{o.push(t(r[e],n-1))}catch(t){}return o.length?o:"string"==i?r:r+"\0"}((r=1==r?{entropy:!0}:r||{}).entropy?[t,b(i)]:null==t?function(){try{var t;return f&&(t=f.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),b(t)}catch(t){var r=o.navigator,n=r&&r.plugins;return[+new Date,o,n,o.screen,b(i)]}}():t,3),e),d=new v(e),y=function(){for(var t=d.g(s),r=l,n=0;t<x;)t=(t+n)*a,r*=a,n=d.g(1);for(;t>=p;)t/=2,r/=2,n>>>=1;return(t+n)/r};return y.int32=function(){return 0|d.g(4)},y.quick=function(){return d.g(4)/4294967296},y.double=y,g(b(d.S),i),(r.pass||n||function(t,r,n,e){return e&&(e.S&&m(e,d),t.state=function(){return m(d,{})}),n?(u[c]=t,r):t})(y,h,"global"in r?r.global:this==u,r.state)}function v(t){var r,n=t.length,e=this,o=0,i=e.i=e.j=0,u=e.S=[];for(n||(t=[n++]);o<a;)u[o]=o++;for(o=0;o<a;o++)u[o]=u[i=h&i+t[o%n]+(r=u[o])],u[i]=r;(e.g=function(t){for(var r,n=0,o=e.i,i=e.j,u=e.S;t--;)r=u[o=h&o+1],n=n*a+u[h&(u[o]=u[i=h&i+r])+(u[i]=r)];return e.i=o,e.j=i,n})(a)}function m(t,r){return r.i=t.i,r.j=t.j,r.S=t.S.slice(),r}function g(t,r){for(var n,e=t+"",o=0;o<e.length;)r[h&o]=h&(n^=19*r[h&o])+e.charCodeAt(o++);return b(r)}function b(t){return String.fromCharCode.apply(0,t)}if(g(u.random(),i),t.exports){t.exports=d;try{f=n(16)}catch(t){}}else void 0===(e=function(){return d}.call(r,n,r,t))||(t.exports=e)}("undefined"!=typeof self?self:this,[],Math)},function(t,r){},function(t,r,n){"use strict";var e=n(18).factory,o=n(21),i=n(22),u=n(26),f=n(27),a=1e-300,s=2848094538889218e-321,c=3.725290298461914e-9,l=.8450629115104675,x=.1283791670955126,p=1.0270333367641007,h=.12837916709551256,d=1,v=-.0023621185607526594,m=1,g=-.009864944034847148,b=1,y=-.0098649429247001,w=1,M=e([-.3250421072470015,-.02848174957559851,-.005770270296489442,-23763016656650163e-21]),N=e([.39791722395915535,.0650222499887673,.005081306281875766,.00013249473800432164,-3960228278775368e-21]),j=e([.41485611868374833,-.3722078760357013,.31834661990116175,-.11089469428239668,.035478304325618236,-.002166375594868791]),k=e([.10642088040084423,.540397917702171,.07182865441419627,.12617121980876164,.01363708391202905,.011984499846799107]),I=e([-.6938585727071818,-10.558626225323291,-62.375332450326006,-162.39666946257347,-184.60509290671104,-81.2874355063066,-9.814329344169145]),A=e([19.651271667439257,137.65775414351904,434.56587747522923,645.3872717332679,429.00814002756783,108.63500554177944,6.570249770319282,-.0604244152148581]),T=e([-.799283237680523,-17.757954917754752,-160.63638485582192,-637.5664433683896,-1025.0951316110772,-483.5191916086514]),S=e([30.33806074348246,325.7925129965739,1536.729586084437,3199.8582195085955,2553.0504064331644,474.52854120695537,-22.44095244658582]);t.exports=function(t){var r,n,e,z,D,q,P;return t!=t?NaN:t===u?1:t===f?-1:0===t?t:(t<0?(r=!0,n=-t):(r=!1,n=t),n<.84375?n<c?n<s?.125*(8*t+p*t):t+x*t:t+t*((z=h+(e=t*t)*M(e))/(D=d+e*N(e))):n<1.25?(q=v+(D=n-1)*j(D),P=m+D*k(D),r?-l-q/P:l+q/P):n>=6?r?a-1:1-a:(D=1/(n*n),n<2.857142857142857?(z=g+D*I(D),D=b+D*A(D)):(z=y+D*T(D),D=w+D*S(D)),e=i(n,0),z=o(-e*e-.5625)*o((e-n)*(e+n)+z/D),r?z/n-1:1-z/n))}},function(t,r,n){"use strict";t.exports=n(19),t.exports.factory=n(20)},function(t,r,n){"use strict";t.exports=function(t,r){var n,e;if((e=t.length)<2||0===r)return 0===e?0:t[0];for(n=t[e-=1]*r+t[e-1],e-=2;e>=0;)n=n*r+t[e],e-=1;return n}},function(t,r,n){"use strict";t.exports=function(t){var r,n,e,o;if(r="return function evalpoly(x){",0===(n=t.length))r+="return 0;";else if(1===n)r+="return "+t[0]+";";else{for(r+="if(x===0){return "+t[0]+";}",r+="return "+t[0],e=n-1,o=1;o<n;o++)r+="+x*",o<e&&(r+="("),r+=t[o];for(o=0;o<e-1;o++)r+=")";r+=";"}return r+="}",new Function(r)()}},function(t,r,n){"use strict";t.exports=Math.exp},function(t,r,n){"use strict";var e=n(23),o=new Float64Array(1),i=new Uint32Array(o.buffer);t.exports=function(t,r){return o[0]=t,i[e]=r>>>0,o[0]}},function(t,r,n){"use strict";var e;e=!0===n(24)?0:1,t.exports=e},function(t,r,n){"use strict";var e,o=n(25);t.exports=((e=new o.uint16(1))[0]=4660,52===new o.uint8(e.buffer)[0])},function(t,r,n){"use strict";var e={uint16:Uint16Array,uint8:Uint8Array};t.exports=e},function(t,r,n){"use strict";t.exports=Number.POSITIVE_INFINITY},function(t,r,n){"use strict";t.exports=Number.NEGATIVE_INFINITY},function(t,r,n){!function(t){"use strict";function r(t){for(var r=new Array(t),n=0;n<t;++n)r[n]=0;return r}function n(t,r){for(var n=0,e=0;e<t.length;++e)n+=t[e]*r[e];return n}function e(t){return Math.sqrt(n(t,t))}function o(t,r,n){for(var e=0;e<r.length;++e)t[e]=r[e]*n}function i(t,r,n,e,o){for(var i=0;i<t.length;++i)t[i]=r*n[i]+e*o[i]}function u(t,r,e,o,u,f,a){var s=e.fx,c=n(e.fxprime,r),l=s,x=s,p=c,h=0;function d(x,h,d){for(var v=0;v<16;++v)if(u=(x+h)/2,i(o.x,1,e.x,u,r),l=o.fx=t(o.x,o.fxprime),p=n(o.fxprime,r),l>s+f*u*c||l>=d)h=u;else{if(Math.abs(p)<=-a*c)return u;p*(h-x)>=0&&(h=x),x=u,d=l}return 0}u=u||1,f=f||1e-6,a=a||.1;for(var v=0;v<10;++v){if(i(o.x,1,e.x,u,r),l=o.fx=t(o.x,o.fxprime),p=n(o.fxprime,r),l>s+f*u*c||v&&l>=x)return d(h,u,x);if(Math.abs(p)<=-a*c)return u;if(p>=0)return d(u,h,l);x=l,h=u,u*=2}return u}t.bisect=function(t,r,n,e){var o=(e=e||{}).maxIterations||100,i=e.tolerance||1e-10,u=t(r),f=t(n),a=n-r;if(u*f>0)throw"Initial bisect points must have opposite signs";if(0===u)return r;if(0===f)return n;for(var s=0;s<o;++s){var c=r+(a/=2),l=t(c);if(l*u>=0&&(r=c),Math.abs(a)<i||0===l)return c}return r+a},t.nelderMead=function(t,r,n){var e,o=(n=n||{}).maxIterations||200*r.length,u=n.nonZeroDelta||1.05,f=n.zeroDelta||.001,a=n.minErrorDelta||1e-6,s=n.minErrorDelta||1e-5,c=void 0!==n.rho?n.rho:1,l=void 0!==n.chi?n.chi:2,x=void 0!==n.psi?n.psi:-.5,p=void 0!==n.sigma?n.sigma:.5,h=r.length,d=new Array(h+1);d[0]=r,d[0].fx=t(r),d[0].id=0;for(var v=0;v<h;++v){var m=r.slice();m[v]=m[v]?m[v]*u:f,d[v+1]=m,d[v+1].fx=t(m),d[v+1].id=v+1}function g(t){for(var r=0;r<t.length;r++)d[h][r]=t[r];d[h].fx=t.fx}for(var b=function(t,r){return t.fx-r.fx},y=r.slice(),w=r.slice(),M=r.slice(),N=r.slice(),j=0;j<o;++j){if(d.sort(b),n.history){var k=d.map((function(t){var r=t.slice();return r.fx=t.fx,r.id=t.id,r}));k.sort((function(t,r){return t.id-r.id})),n.history.push({x:d[0].slice(),fx:d[0].fx,simplex:k})}for(e=0,v=0;v<h;++v)e=Math.max(e,Math.abs(d[0][v]-d[1][v]));if(Math.abs(d[0].fx-d[h].fx)<a&&e<s)break;for(v=0;v<h;++v){y[v]=0;for(var I=0;I<h;++I)y[v]+=d[I][v];y[v]/=h}var A=d[h];if(i(w,1+c,y,-c,A),w.fx=t(w),w.fx<d[0].fx)i(N,1+l,y,-l,A),N.fx=t(N),N.fx<w.fx?g(N):g(w);else if(w.fx>=d[h-1].fx){var T=!1;if(w.fx>A.fx?(i(M,1+x,y,-x,A),M.fx=t(M),M.fx<A.fx?g(M):T=!0):(i(M,1-x*c,y,x*c,A),M.fx=t(M),M.fx<w.fx?g(M):T=!0),T){if(p>=1)break;for(v=1;v<d.length;++v)i(d[v],1-p,d[0],p,d[v]),d[v].fx=t(d[v])}}else g(w)}return d.sort(b),{fx:d[0].fx,x:d[0]}},t.conjugateGradient=function(t,r,f){var a,s,c,l={x:r.slice(),fx:0,fxprime:r.slice()},x={x:r.slice(),fx:0,fxprime:r.slice()},p=r.slice(),h=1;c=(f=f||{}).maxIterations||20*r.length,l.fx=t(l.x,l.fxprime),o(a=l.fxprime.slice(),l.fxprime,-1);for(var d=0;d<c;++d){if(h=u(t,a,l,x,h),f.history&&f.history.push({x:l.x.slice(),fx:l.fx,fxprime:l.fxprime.slice(),alpha:h}),h){i(p,1,x.fxprime,-1,l.fxprime);var v=n(l.fxprime,l.fxprime);i(a,Math.max(0,n(p,x.fxprime)/v),a,-1,x.fxprime),s=l,l=x,x=s}else o(a,l.fxprime,-1);if(e(l.fxprime)<=1e-5)break}return f.history&&f.history.push({x:l.x.slice(),fx:l.fx,fxprime:l.fxprime.slice(),alpha:h}),l},t.gradientDescent=function(t,r,n){for(var o=(n=n||{}).maxIterations||100*r.length,u=n.learnRate||.001,f={x:r.slice(),fx:0,fxprime:r.slice()},a=0;a<o&&(f.fx=t(f.x,f.fxprime),n.history&&n.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice()}),i(f.x,1,f.x,-u,f.fxprime),!(e(f.fxprime)<=1e-5));++a);return f},t.gradientDescentLineSearch=function(t,r,n){n=n||{};var i,f={x:r.slice(),fx:0,fxprime:r.slice()},a={x:r.slice(),fx:0,fxprime:r.slice()},s=n.maxIterations||100*r.length,c=n.learnRate||1,l=r.slice(),x=n.c1||.001,p=n.c2||.1,h=[];if(n.history){var d=t;t=function(t,r){return h.push(t.slice()),d(t,r)}}f.fx=t(f.x,f.fxprime);for(var v=0;v<s&&(o(l,f.fxprime,-1),c=u(t,l,f,a,c,x,p),n.history&&(n.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice(),functionCalls:h,learnRate:c,alpha:c}),h=[]),i=f,f=a,a=i,!(0===c||e(f.fxprime)<1e-5));++v);return f},t.zeros=r,t.zerosM=function(t,n){return r(t).map((function(){return r(n)}))},t.norm2=e,t.weightedSum=i,t.scale=o}(r)}]);